---
title: 'Configuración para muestras de gestión de reproductores'
description: 'Esta página describe cómo se escriben las muestras básicas para el nuevo reproductor. Esto incluye detalles sobre la autenticación básica y cómo se usa AJAX en las muestras de la API de administración de reproductores.'
parent: Code Samples 
grandparent: Player Management API
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
    <section class="bcls-section">
    <h2 id="Introduction">Introducción</h2>
    
    <p>En el paso a paso: Documento de gestión de reproductores que utilizó declaraciones curl para interactuar con la API. Cuando se realizó una llamada a la API, se le solicitó de forma interactiva una contraseña. Si bien esto funciona bien para curl, este tipo de autenticación interactiva no es factible cuando se crea una aplicación.</p>
    
    <p>Aquí aprenderá cómo realiza las solicitudes de API utilizando JavaScript y XMLHttpRequest, también conocido como AJAX, para crear clientes web para operaciones de administración de reproductores.</p>
    
    <p>Porque la API de administración de reproductores es <a href="https://general.support.brightcove.com/developer/concepts-cors.html">Compatible con CORS</a> y permite la autenticación básica con sus credenciales de inicio de sesión de Brightcove, es posible realizar solicitudes de API directamente desde una página web, como hacemos en las muestras de API de gestión de reproductores. Las otras API RESTful de Brightcove requieren autenticación a través de <a href="/oauth/index.html">OAuth</a>. Dado que la API utilizada para recuperar los tokens de acceso no está habilitada para CORS (ni las API mismas), debe realizar solicitudes a través de una aplicación del lado del servidor. Ver <a href="/getting-started/learning-guide-using-rest-apis.html">Usando las API REST</a> para obtener una guía sobre cómo crear aplicaciones híbridas con una interfaz de usuario web y un proxy para acceder a las API REST. Este es el enfoque que recomendamos para las aplicaciones que utilizan Player Management API en producción también, porque es más seguro y no envía credenciales a través de conexiones HTTP.</p>
    
    <aside class="bcls-aside bcls-aside--warning">
    <p>Las aplicaciones de muestra a las que se hace referencia en esta página están pensadas como una forma de explorar los conceptos básicos de la API de administración de reproductores. No están diseñadas para ser aplicaciones desplegables listas para la empresa. Por ejemplo, la validación de formularios no es exhaustiva y las contraseñas NO se envían utilizando HTTPS.</p>
    </aside>
    </section>
    
    <section class="bcls-section">
    <h2 id="Basic_authentication">Autenticación básica</h2>
    
    <p>En el paso a paso: Documento de gestión de reproductores que utilizó declaraciones curl para interactuar con la API. Cuando se realizó una llamada a la API, se le solicitó de forma interactiva una contraseña. Si bien esto funciona bien para curl, este tipo de autenticación interactiva no es factible cuando se crea una aplicación.</p>
    
    <p>Puede utilizar la autenticación básica al crear una aplicación. En el encabezado, debe enviar las credenciales, cifradas en una cadena ASCII codificada en base 64. Puede utilizar JavaScript <code translate="No">btoa()</code> método para hacer la codificación. Asumiendo <code translate="No">account_username</code> y <code translate="No">account_password</code> se rellenan desde, por ejemplo, un formulario, el encabezado de Autorización aparecería de la siguiente manera:</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No"> "Authorization": "Basic " + btoa(account_username + ":" + account_password),</code></pre>
    </section>
    
    <section id="ajax" class="bcls-section">
    <h2>AJAX</h2>
    
    <aside class="bcls-aside bcls-aside--information">
    <p>En esta sección, aprenderá a usar AJAX usando <a href="//jquery.org">jQuery</a> . jQuery encapsula los comandos involucrados en hacer solicitudes AJAX en una función ajax (), y así simplifica las cosas para usted como desarrollador. Sin embargo, no se requiere jQuery para AJAX, y en la siguiente sección, le mostraremos cómo realizar solicitudes AJAX con JavaScript simple.</p>
    </aside>
    
    <p>En lugar de usar declaraciones curl, estas muestras usarán JavaScript para comunicarse con la API. Esto significa usar AJAX para emitir la solicitud a la API. Una solicitud de ejemplo específica podría verse así:</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No">$.ajax({
        type: "DELETE",
        headers: {
        "Authorization": "Basic " + btoa("username:password"),
        "Content-Type": "application/json"
        },
        url: "https://players.api.brightcove.com/v2/accounts/123456789/players/478772a5-a2f2-44c6-a26b-2d7234bd97f5",
        success: ajaxSuccess,
        error: ajaxError
    });</code></pre>
    
    <p>Asociado <code translate="No">success</code> y <code translate="No">error</code> los controladores podrían verse así:</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No">var ajaxSuccess = function (data) {
        document.getElementById("jsonResponse").innerHTML = JSON.stringify(data,null,2);
        };
    
        var ajaxError = function (data) {
        console.log("error data: ");
        console.log(data);
    };</code></pre>
    
    <p>Por supuesto, no desea codificar toda la información en la llamada AJAX como se muestra arriba, por lo que tiene sentido abstraer la llamada real a una función que sea reutilizable, como se muestra aquí:</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No">var makeAjaxCall = function (callURL, callType, callData) {
        if (callData) {
            $.ajax({
                type: callType,
                headers: {
                    "Authorization": "Basic " + btoa(account_username + ":" + account_password),
                    "Content-Type": "application/json"
                },
                url: callURL,
                data: JSON.stringify(callData),
                success: ajaxSuccess,
                error: ajaxError
            });
        } else {
            $.ajax({
            type: callType,
            headers: {
                "Authorization": "Basic " + btoa(account_username + ":" + account_password),
                "Content-Type": "application/json"
            },
            url: callURL,
            success: ajaxSuccess,
            error: ajaxError
            });
        }
    };</code></pre>
    <!-- <code data-gist-id="9216425" data-gist-hide-footer="true" data-gist-line="22-47"></code><br /> -->
    
    <aside class="bcls-aside bcls-aside--information">Se crean llamadas separadas si es necesario pasar datos con la llamada a la API. En el paso a paso: Documento de gestión de reproductores que ha visto en ambos casos de uso. La publicación de un reproductor no requiere la transmisión de datos, mientras que la creación de un reproductor con una fuente de medios sí requiere la transmisión de datos.</aside>
    
    <p>Entonces estará listo para llamar a la función. En el siguiente ejemplo, el <code translate="No">account_id</code> , <code translate="No">account_password</code> y <code translate="No">account_username</code> todos los valores se extraen de un formulario.</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No">var getPlayerInfo = function () {
        account_id = document.getElementById("account_id").value,
        account_password = document.getElementById("account_password").value,
        account_username = document.getElementById("account_username").value;
        call_url = "https://players.api.brightcove.com/v2/accounts/" + account_id + "/players";
        makeAjaxCall(call_url, "GET", null);
    };</code></pre>
    <!-- <code data-gist-id="9216425" data-gist-hide-footer="true" data-gist-line="49-55"></code><br /> -->
    
    <p>Si ha completado el paso a paso: Player Management documenta que sabe que algunos procesos aceptan múltiples llamadas a la API, como crear y publicar un reproductor. Además, la lógica de algunas aplicaciones puede requerir múltiples llamadas a la API, como obtener una lista de todos los reproductores para mostrar y luego eliminar los reproductores que el usuario marcó. En estos casos, lo más probable es que deba modificar su <code translate="No">success</code> handler para realizar una lógica diferente en función de la llamada que se llevó a cabo con éxito. En estas aplicaciones de muestra, la lógica de implementación para estos casos de uso se implementará mediante una variable de marca, <code translate="No">callPurpose</code> y un <code translate="No">case</code> declaración usando esa bandera, como se muestra aquí:</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No">var ajaxSuccess = function (data) {
        switch (callPurpose) {
            case "getPlayers":
                createCheckboxes(data);
                watchCheckboxes();
                break;
            case "deletePlayer":
                document.getElementById("jsonResponse").textContent += data;
                break;
        }
    };</code></pre>
    </section>
    
    <section class="bcls-section">
    <h2 id="AJAX_without_jquery">AJAX sin jQuery</h2>
    
    <p>Si prefiere no usar jQuery, realizar solicitudes AJAX es un poco más complejo, pero no demasiado. Aquí hay un código de muestra, con comentarios, para comenzar:</p>
    
    <pre class="line-numbers">
    <code class="language-javascript" translate="No">/**
     * createRequest sets up requests, send them to makeRequest(), and handles responses
     * @param  {string} type the request type
     */
    function createRequest(type) {
        var options   = {},
            baseURL = 'https://players.api.brightcove.com/v2/accounts/',
            account_id = '1234567890',
            // would be better to get these from form fields
            // and not hardcode them
            username = 'jane@myplace.com',
            password = 'mypassword',
            responseDecoded;
    
        // set credentials
        options.client_id     = cid.value;
        options.client_secret = secret.value;
    
        switch (type) {
            case 'getPlayers':
                options.url         = ipBaseURL + account_id + '/players';
                options.requestType = 'GET';
                options.username = username;
                options.password = password;
                makeRequest(options, function(response) {
                    // use try catch in case something went wrong
                    try {
                        responseDecoded = JSON.parse(response);
                        // now do whatever you want with the response
                    }
                    catch (e) {
                        console.log('something went wrong - this was the JSON.parse error: ' + e);
                    }
                });
                break;
            // additional cases
            default:
                console.log('Should not be getting to the default case - bad request type sent');
                break;
        }
    }
    
    /**
     * send API request
     * @param  {Object} options for the request
     * @param  {String} options.url the full API request URL
     * @param  {String="GET","POST","PATCH","PUT","DELETE"} requestData [options.requestType="GET"] HTTP type for the request
     * @param  {String} options.username username for the account
     * @param  {String} options.password password for the account
     * @param  {JSON} [options.requestBody] Data (if any) to be sent in the request body in the form of a JSON string
     * @param  {Function} [callback] callback function that will process the response
     */
    function makeRequest(options, callback) {
        var httpRequest = new XMLHttpRequest(),
            response,
            requestParams,
            dataString,
            // response handler
            getResponse = function() {
                try {
                    if (httpRequest.readyState === 4) {
                        // don't just check for status = 200
                        // some requests return other 2xx codes
                        if (httpRequest.status &gt;= 200 &amp;&amp; httpRequest.status &lt; 300) {
                            response = httpRequest.responseText;
                            // return the response to the callback
                            callback(response);
                        } else {
                            alert('There was a problem with the request. Request returned ' + httpRequest.status);
                        }
                    }
                } catch (e) {
                    alert('Caught Exception: ' + e);
                }
            };
        /**
         * set up request data
         */
        // set response handler
        httpRequest.onreadystatechange = getResponse;
        // open the request
        httpRequest.open(options.requestType, options.url);
        // set headers
        httpRequest.setRequestHeader("Content-Type", "application/json");
        httpRequest.setRequestHeader("Authorization", "Basic " + btoa(options.username + ":" + options.password));
        // open and send request
        if (options.requestBody) {
            httpRequest.send(options.requestBody)
        } else {
            httpRequest.send();
        }
    }</code></pre>
    </section>
    </article>
 